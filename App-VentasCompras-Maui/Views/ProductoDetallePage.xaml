<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:App_VentasCompras_Maui.ViewModel"
             xmlns:models="clr-namespace:App_VentasCompras_Maui.Models"
             x:Class="App_VentasCompras_Maui.Views.ProductoDetallePage"
             x:DataType="vm:ProductoDetalleViewModel"
             NavigationPage.HasNavigationBar="False"
             BackgroundColor="#001111"
             Title="Detalle del Producto">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <!--  Encabezado con logo y título -->
            <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                <Image Source="logo_app.png"
                       WidthRequest="40"
                       HeightRequest="40"
                       VerticalOptions="Center"/>
                <Label Text="Detalle del Producto"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="White"
                       VerticalOptions="Center"/>
            </HorizontalStackLayout>

            <!--  Imagen -->
            <Frame BorderColor="Gray" CornerRadius="15" BackgroundColor="White">
                <Image Source="{Binding Producto.Imagen}"
                       Aspect="AspectFit"
                       HeightRequest="250"/>
            </Frame>

            <!-- Información del producto -->
            <Grid ColumnDefinitions="Auto,*" RowSpacing="10" ColumnSpacing="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- Nombre -->
                    <RowDefinition Height="Auto"/>
                    <!-- Descripción -->
                    <RowDefinition Height="Auto"/>
                    <!-- Precio -->
                    <RowDefinition Height="Auto"/>
                    <!-- Stock -->
                    <RowDefinition Height="Auto"/>
                    <!-- Categoría -->
                    <RowDefinition Height="Auto"/>
                    <!-- Estado Venta -->
                    <RowDefinition Height="Auto"/>
                    <!-- Estado Producto -->
                    <RowDefinition Height="Auto"/>
                    <!-- Nombre usuario -->
                    <RowDefinition Height="Auto"/>
                    <!-- Apellido -->
                    <RowDefinition Height="Auto"/>
                    <!-- País -->
                    <RowDefinition Height="Auto"/>
                    <!-- Provincia -->
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Grid.Column="0" Text="Nombre:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="0" Grid.Column="1" Text="{Binding Producto.NombreProducto}" IsReadOnly="True"/>

                <Label Grid.Row="1" Grid.Column="0" Text="Descripción:" TextColor="White" VerticalOptions="Start"/>
                <Editor Grid.Row="1" Grid.Column="1" Text="{Binding Producto.Descripcion}" 
                        IsReadOnly="True" MaxLength="1000" 
                        BackgroundColor="#1E1E1E" TextColor="White"
                        AutoSize="TextChanges"/>

                <Label Grid.Row="2" Grid.Column="0" Text="Precio:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="2" Grid.Column="1" Text="{Binding Producto.Precio}" IsReadOnly="True"/>

                <Label Grid.Row="3" Grid.Column="0" Text="Stock:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="3" Grid.Column="1" Text="{Binding Producto.Cantidad}" IsReadOnly="True"/>

                <Label Grid.Row="4" Grid.Column="0" Text="Categoría:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="4" Grid.Column="1" Text="{Binding Producto.NombreCategoria}" IsReadOnly="True"/>

                <Label Grid.Row="5" Grid.Column="0" Text="Estado Publicación:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="5" Grid.Column="1" Text="{Binding Producto.EstadoVenta}" IsReadOnly="True"/>

                <Label Grid.Row="6" Grid.Column="0" Text="Estado Producto:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="6" Grid.Column="1" Text="{Binding Producto.EstadoProducto}" IsReadOnly="True"/>



                <Label Grid.Row="7" Grid.Column="0" Text="Vendedor:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="7" Grid.Column="1" Text="{Binding Producto.Username}" IsReadOnly="True"/>

                <Label Grid.Row="8" Grid.Column="0" Text="Email:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="8" Grid.Column="1" Text="{Binding Producto.Email}" IsReadOnly="True"/>

                <Label Grid.Row="9" Grid.Column="0" Text="Numero telefonico:" TextColor="White" VerticalOptions="Center"/>
                <Entry Grid.Row="9" Grid.Column="1" Text="{Binding Producto.NroCelular}" IsReadOnly="True"/>
            </Grid>

            <Button Text="Ver perfil del vendedor"
                    Command="{Binding VerPerfilVendedorCommand}"
                    BackgroundColor="#FFA500"
                    TextColor="White"
                    CornerRadius="10"
                    HeightRequest="45"
                    Margin="0,15,0,0"/>
            <StackLayout IsVisible="{Binding EsPropietario}" Orientation="Horizontal" HorizontalOptions="Center" Spacing="20" Margin="0,15">
                <Button Text="Editar"
                        Command="{Binding EditarProductoCommand}"
                        BackgroundColor="DodgerBlue"
                        TextColor="White"
                        WidthRequest="120"/>
                <Button Text="Eliminar"
                        Command="{Binding EliminarCommand}"
                        CommandParameter="{Binding Producto.IDProducto}"
                        BackgroundColor="Red"
                        TextColor="White"
                        WidthRequest="120"/>
            </StackLayout>

             <!-- Seccion para Opiniones -->
            <StackLayout IsVisible="{Binding Contactado}" Margin="0,20,0,0" Spacing="15">
                <Label Text="¿Cómo fue tu experiencia con el vendedor?" 
                       TextColor="White" 
                       FontAttributes="Bold" 
                       FontSize="18"
                       HorizontalOptions="Center" />

                <StackLayout>
                    <HorizontalStackLayout Spacing="10">
                        <CheckBox IsChecked="{Binding CheckBueno}" Color="Green"/>
                        <Label Text="Bueno" TextColor="White" VerticalOptions="Center" />
                    </HorizontalStackLayout>

                    <HorizontalStackLayout Spacing="10">
                        <CheckBox IsChecked="{Binding CheckRegular}" Color="Orange"/>
                        <Label Text="Regular" TextColor="White" VerticalOptions="Center" />
                    </HorizontalStackLayout>

                    <HorizontalStackLayout Spacing="10">
                        <CheckBox IsChecked="{Binding CheckMalo}" Color="Red"/>
                        <Label Text="Malo" TextColor="White" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </StackLayout>

                <Label Text="¿Marcás este producto como compra exitosa?"
                       TextColor="White"
                       FontAttributes="Bold"
                       FontSize="16"
                       HorizontalOptions="Center" />

                <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                    <CheckBox IsChecked="{Binding Compro}" Color="#2B0B98"/>
                    <Label Text="Sí, realicé la compra" TextColor="White" VerticalOptions="Center"/>
                </HorizontalStackLayout>

                <Button Text="Guardar valoración"
                        Command="{Binding GuardarValoracionCommand}"
                        BackgroundColor="#9C6EFF"
                        TextColor="White"
                        HeightRequest="45"
                        CornerRadius="10"
                        Margin="0,10" />
            </StackLayout>
            
            
            <!-- Acciones comunes -->
            <Button Text="Contactar" IsVisible="{Binding MostrarBotonContactar}"
                    Command="{Binding GoContactarCommand}"
                    BackgroundColor="Blue"
                    TextColor="White"
                    CornerRadius="15"
                    HeightRequest="45"
                    Margin="0,10"/>

            <Button Text="Volver a Lista"
                    Command="{Binding GoBackCommand}"
                    BackgroundColor="Gray"
                    TextColor="White"
                    CornerRadius="15"
                    HeightRequest="45"/>
        </VerticalStackLayout> 
    </ScrollView>
</ContentPage>
